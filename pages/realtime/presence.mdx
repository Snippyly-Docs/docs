import Subheading from '../../components/Subheading/Subheading.tsx';
import PresenceDemo from '../../components/PresenceDemo/PresenceDemo.tsx';
import SplitPane from '../../components/SplitPane/SplitPane.tsx';
import Step from '../../components/Step/Step.tsx';
import CodeSampleWrapper from '../../components/CodeSampleWrapper/CodeSampleWrapper.tsx';
import { useState } from 'react';

# Presence [#presence]

<Subheading>Your users can see who is online on this page.</Subheading>
<PresenceDemo />

# Steps [#steps]

export function PresenceSample() {

  const highlightRangeMap = {
    1: [2, 2],
    2: [7, 13],
    3: [16, 18],
    4: [16, 18]
  };
  
  const [step, setStep] = useState(1);
  const [scrollLine, setScrollLine] = useState(undefined);
  const [highlightRange, setHighlightRange] = useState(highlightRangeMap[1]);

  const handleStepChanged = (step) => {
    setHighlightRange(highlightRangeMap[step]);
    setStep(step);
  }

  return (
    <SplitPane
      left={
        <>
          <Step 
            step={1}
            handleClick={() => handleStepChanged(1)}
            title="Import Presence Component"
            active={step === 1}
            description={
              <>
                <strong>Import the component from our React library.</strong>
                <p>We offer a specific component for our users that use React.</p>
              </>
            }
          />
          <Step
            step={2}
            handleClick={() => handleStepChanged(2)}
            title="Identify the user"
            active={step === 2}
            description={
              <>
                <strong>If you haven't already done so:</strong>
                <p>The user must be identified atleast once prior to using the Presence component. Here is an example of generating fake user data for testing purposes.</p>
              </>
            }
          />
          <Step 
            step={3}
            handleClick={() => handleStepChanged(3)}
            title="Add Presence Component"
            active={step === 3}
            description={
              <>
                <strong>Add it anywhere you want to see the user avatars.</strong>
                <p>This component renders the avatars of users on the same page in your web app.</p>
              </>
            }
          />
          <Step 
            step={4}
            handleClick={() => handleStepChanged(4)}
            title="Test Integration"
            active={step === 4}
            description={
              <>
                <strong>Test it out by opening the same page in another browser.</strong>
                <p>When you open the same page in another incognito window or browser, you should see the avatars of both users.</p>
              </>
            }
          />
        </>
      }
      right={
        <CodeSampleWrapper
          scrollToLine={scrollLine}
          highlightRange={highlightRange}
          code={
`

import { SnippylyPresence } from '@snippyly/react';
import { useEffect } from 'react';

export default function App() {

  useEffect(() => {
    if (client) {
      client.setDocumentId('presence-docs');
      const yourLoggedInUser = generateUserData();
      client.identify(yourLoggedInUser)
    }
  }, [client]);

  return (
    <>
      <SnippylyPresence />
    </>
  );
}
    `}
        />
      }
    />
  );
}

<PresenceSample />

# Customize Behavior [#customize-behavior]
# Customize UI [#customize-ui]